

### publikace:

* Energetics of hydrogen bonds in peptides https://www.pnas.org/doi/10.1073/pnas.2133366100
    - asi tam odsud ukrást hodnotu ~1.5 kcal/mol?


### osnova

co je NA, co je par, saenger a LW nazvoslovi
pary byly poskytnuty od freda, autor je Craig
ensembl byl poskytnut jirkou

publikace se muze prekryvat, to je jedno
 - chteji pridat CIF kategorii, rigorozni definici
 - chteji konzervativni definici

je ok psát o implementaci?
 - B: určitě rozepsat
 - pymol skript
 - preskakuju non-std residua
web?
 - B: samozrejme

### blbost

Interesting pair: 6W6L 1 D 40  D 104  both parallel and antiparallel

### Citace

NAKB, DNATCO aspoň


```sql
CREATE OR REPLACE TEMP MACRO sanitize_alt(a) AS nullif(nullif(nullif(trim(a), chr(0)), '?'), '');
CREATE OR REPLACE TEMP MACRO format_altdot(a) AS coalesce('.' || sanitize_alt(a), '');


copy(
    select * replace (
        lower(pdbid) as pdbid,
        sanitize_alt(alt1) AS alt1,
        sanitize_alt(ins1) as ins1,
        sanitize_alt(alt2) as alt2,
        sanitize_alt(ins2) as ins2
    )
    from '/mnt/Aldabrachelys/test/vsecky-pary-raw.parquet'
)
to '/mnt/Aldabrachelys/test/vsecky-pary.parquet' (format parquet);

copy(
select * from '/mnt/Aldabrachelys/test/vsecky-pary.parquet'
    where lower(pdbid || '_' || chain1 || '_' || res1 || format_altdot(alt1) || '_' || nr1::text || format_altdot(ins1)) in (select lower(column0) from '~/tmp/basepaircsv/hbonds/*.csv')
    or lower(pdbid || '_' || chain2 || '_' || res2 || format_altdot(alt2) || '_' || nr2::text || format_altdot(ins2)) in (select lower(column0) from '~/tmp/basepaircsv/hbonds/*.csv'))
to '/mnt/Aldabrachelys/test/vsecky-pary-refset.parquet' (format parquet);

copy(
    select pdbid, model, chain1, res1, nr1, ins1, alt1, chain2, res2, nr2, ins2, alt2,
        --    tripletx, triplety, tripletz, pdbsymstr, gemmisymstr, gemmi_shortest
        NULL::text as symmetry_operation1, nullif(pdbsymstr, '1_555') as symmetry_operation2
    from '/mnt/Aldabrachelys/test/vsecky-pary-refset.parquet'
)
to '/mnt/Aldabrachelys/test/vsecky-pary-refsetID.parquet' (format parquet);

copy(
    select pdbid, model, chain2 as chain1, res2 as res1, nr2 as nr1, ins2 as ins1, alt2 as alt1, chain1 as chain2, res1 as res2, nr1 as nr2, ins1 as ins2, alt1 as alt2,
        --    tripletx, triplety, tripletz, pdbsymstr, gemmisymstr, gemmi_shortest
        nullif(pdbsymstr, '1_555') as symmetry_operation1, NULL::text as symmetry_operation2
    from '/mnt/Aldabrachelys/test/vsecky-pary-refset.parquet'
)
to '/mnt/Aldabrachelys/test/vsecky-pary-refsetIDinv.parquet' (format parquet);

--python3 ./pairs.py /mnt/Aldabrachelys/test/pdb/fr3d_6e88eb7d_bpdet/*_basepair_detail.txt --pdbcache /mnt/Aldabrachelys/test/pdb/s --threads 32 --export-only --output /mnt/Aldabrachelys/test/pdb/analyzed-bonds/fr3d-exportonly.csv


copy(
    select lower(pdbid) as pdbid, model, chain1, res1, nr1, ins1, alt1, chain2, res2, nr2, ins2, alt2, symmetry_operation1, symmetry_operation2
    from '/mnt/Aldabrachelys/test/pdb/analyzed-bonds/fr3d-exportonly.csv.parquet'
    where lower(pdbid || '_' || chain1 || '_' || res1 || format_altdot(alt1) || '_' || nr1::text || format_altdot(ins1)) in (select lower(column0) from '~/tmp/basepaircsv/hbonds/*.csv')
       or lower(pdbid || '_' || chain2 || '_' || res2 || format_altdot(alt2) || '_' || nr2::text || format_altdot(ins2)) in (select lower(column0) from '~/tmp/basepaircsv/hbonds/*.csv')
)
to '/mnt/Aldabrachelys/test/pdb/analyzed-bonds/fr3d-exportonly-refset-ID.parquet';




copy (select * from '/home/exyi/code/rna-ml/pairclusters/out/plots-reexport0413/*-filtered.parquet') to '/mnt/Aldabrachelys/test/pymol-vids/work/all-approved-detailed.parquet' (format parquet);
```



WebTODO

* rozsirit hranice
* O2' vazby zrušit
* chytřejší vazby
* proc se nespocital cWH C-C
* NULLy v jednom z fieldů?
* cWB, cHHa, cWWa, tWWa
* cWW AA symetrické páry

fetch 3vjr
select pair, 3vjr and (chain B and resi 33 or chain D and resi 33)
show sticks, %pair
orient %pair
hide everything, not %pair

